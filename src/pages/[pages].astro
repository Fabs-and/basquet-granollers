---
// Import utils
import { fetchPages } from "@utils/apiFunctions/index";

// Import types
import type { Page } from "src/types";

import PageLayout from "@layouts/PageLayout.astro";

import { EXCLUDED_PAGES, PAGE_FIELDS } from "src/globalConstants";

export async function getStaticPaths() {
  const wpPages = await fetchPages(100, PAGE_FIELDS);

  const pagesToGenerate = wpPages.filter(
    (page) => !EXCLUDED_PAGES.has(page.slug),
  );

  return pagesToGenerate.map((page: Page) => {
    return {
      params: { pages: page.slug },
      props: {
        title: page.title.rendered,
        content: page.content.rendered,
        date: page.date,
        image: page.image,
      },
    };
  });
}

const page = Astro.props;
---

<PageLayout post={page} pageTitle={page.title.rendered} />
